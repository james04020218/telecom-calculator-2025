<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LG HelloVision ê²°í•© í• ì¸ ê³„ì‚°ê¸°</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { font-family: 'Inter', sans-serif; background-color: #f7fee7; /* lime-50 */ }
        .input-group { margin-bottom: 1.5rem; }
        .input-label { display: block; margin-bottom: 0.5rem; font-weight: 500; color: #3f6212; /* lime-800 */ }
        .input-field, .select-field { width: 100%; padding: 0.5rem 0.75rem; border: 1px solid #a3e635; /* lime-400 */ border-radius: 0.375rem; box-shadow: sm; transition: border-color 0.15s ease-in-out, box-shadow 0.15s ease-in-out; }
        .input-field:focus, .select-field:focus { border-color: #65a30d; /* lime-600 */ outline: none; box-shadow: 0 0 0 0.2rem rgba(101, 163, 13, 0.25); }
        .input-field:disabled, .select-field:disabled { background-color: #f0fdf4; /* green-50 */ cursor: not-allowed; opacity: 0.7; }
        .btn-primary { background-color: #84cc16; /* lime-500 */ color: white; padding: 0.75rem 1.5rem; border-radius: 0.375rem; font-weight: 600; transition: background-color 0.3s ease; }
        .btn-primary:hover { background-color: #65a30d; /* lime-600 */ }
        .btn-secondary { background-color: #6b7280; /* gray-500 */ color: white; padding: 0.5rem 1rem; border-radius: 0.375rem; font-weight: 500; transition: background-color 0.3s ease; }
        .btn-secondary:hover { background-color: #4b5563; /* gray-600 */ }
        .section-title { font-size: 1.5rem; font-weight: 700; color: #4d7c0f; /* lime-700 */ margin-bottom: 1rem; padding-bottom: 0.5rem; border-bottom: 2px solid #a3e635 /* lime-400 */;}
        .result-card { background-color: white; padding: 1.5rem; border-radius: 0.5rem; box-shadow: 0 4px 6px -1px rgba(0,0,0,0.1), 0 2px 4px -1px rgba(0,0,0,0.06); margin-bottom: 1.5rem; }
        .result-label { color: #374151; /* gray-700 */ }
        .result-value { color: #1f2937; /* gray-800 */ font-weight: 600;}
        .total-value { color: #65a30d; /* lime-600 */ font-size: 1.5rem; font-weight: 700;}
        .mobile-line-item { border: 1px solid #d1d5db; /* gray-300 */ padding: 1rem; border-radius: 0.375rem; margin-bottom: 0.75rem; }
        .radio-label { margin-right: 1rem; margin-bottom: 0.5rem; display: inline-flex; align-items: center; cursor: pointer;}
        .radio-input { margin-right: 0.5rem; accent-color: #84cc16; /* lime-500 */ }
        .toggle-switch { position: relative; display: inline-block; width: 40px; height: 20px; margin-left: 10px; vertical-align: middle;}
        .toggle-switch input { opacity: 0; width: 0; height: 0; }
        .slider { position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background-color: #ccc; transition: .4s; border-radius: 20px;}
        .slider:before { position: absolute; content: ""; height: 16px; width: 16px; left: 2px; bottom: 2px; background-color: white; transition: .4s; border-radius: 50%;}
        input:checked + .slider { background-color: #84cc16; /* lime-500 */ }
        input:checked + .slider:before { transform: translateX(20px); }
        .discount-details { background-color: #ecfccb; /* lime-100 */ border: 1px solid #d9f99d; /* lime-300 */ padding: 0.75rem; border-radius: 0.375rem; font-size:0.875rem; }
        .discount-details ul { padding-left: 1.25rem; list-style-type: disc; margin-left: 0.5rem;}
        .discount-details ul ul { padding-left: 1rem; list-style-type: circle; }
        .discount-details table { width: 100%; margin-bottom: 0.5rem; }
        .discount-details th, .discount-details td { padding: 0.25rem 0.5rem; text-align: left; border: 1px solid #d9f99d; /* lime-200 */ }
        .discount-details th { background-color: #f0fdf4; /* green-50 */ }
        .summary-item { margin-bottom: 0.25rem; }
        .message-script-area { width: 100%; min-height: 100px; padding: 0.5rem; border: 1px solid #cbd5e1; border-radius: 0.375rem; font-size: 0.875rem; white-space: pre-wrap; word-wrap: break-word; }
        .copy-button-container { text-align: right; margin-top: 0.5rem; }
        .copy-feedback { font-size: 0.75rem; color: green; margin-left: 0.5rem; }
    </style>
</head>
<body class="text-slate-800">
    <header class="bg-lime-600 text-white p-6 shadow-md">
        <div class="container mx-auto max-w-4xl">
            <h1 class="text-3xl font-bold text-center">LG HelloVision ê²°í•© í• ì¸ ê³„ì‚°ê¸°</h1>
            <p class="text-center text-lime-100 mt-1">ì„ íƒí•˜ì‹  ì„œë¹„ìŠ¤ì™€ í• ì¸ ìœ í˜•ì— ë”°ë¥¸ ì˜ˆìƒ ìš”ê¸ˆì„ ê³„ì‚°í•´ ë³´ì„¸ìš”.</p>
        </div>
    </header>

    <main class="container mx-auto max-w-4xl p-4 sm:p-6 lg:p-8">
        <section id="inputSection" class="mb-8">
            <h2 class="section-title">1. ì„œë¹„ìŠ¤ ì„ íƒ (ì•½ì • ë° VAT í¬í•¨ ê¸°ì¤€)</h2>
            <p class="mb-6 text-sm text-slate-600">ì•„ë˜ í•­ëª©ë“¤ì„ ì„ íƒí•´ì£¼ì„¸ìš”. ìš”ê¸ˆì€ LGí—¬ë¡œë¹„ì „ í‘œì¤€ ì•½ì • ê¸°ì¤€ì…ë‹ˆë‹¤.</p>
            
            <div class="input-group">
                <label class="input-label">ì¸í„°ë„· ìœ í˜• ì„ íƒ</label>
                <div class="flex items-center space-x-4">
                    <label class="radio-label"><input type="radio" name="internetType" value="bundle" class="radio-input" checked> ì¸í„°ë„· + TV ë²ˆë“¤</label>
                    <label class="radio-label"><input type="radio" name="internetType" value="standalone" class="radio-input"> ì¸í„°ë„· ë‹¨ë…</label>
                </div>
            </div>

            <div class="grid md:grid-cols-2 gap-6">
                <div class="input-group">
                    <label for="internetPlan" class="input-label">ì¸í„°ë„· ìš”ê¸ˆì œ</label>
                    <select id="internetPlan" class="select-field">
                        <option value="none">ì„ íƒ ì•ˆí•¨</option>
                        {/* Options will be populated by JavaScript */}
                    </select>
                    <p class="text-xs text-slate-500 mt-1" id="internetNotes">ì°¸ê³ : WiFi ê³µìœ ê¸° ë¬´ë£Œ ì œê³µ.</p>
                </div>
                
                <div class="input-group">
                    <label for="tvPlan" class="input-label">í—¬ë¡œtv ìš”ê¸ˆì œ (1ë²ˆì§¸ TV)</label>
                    <select id="tvPlan" class="select-field">
                        <option value="none">ì„ íƒ ì•ˆí•¨</option>
                        {/* Options will be populated by JavaScript */}
                    </select>
                     <p class="text-xs text-slate-500 mt-1">ì°¸ê³ : ì…‹í†±ë°•ìŠ¤ í¬í•¨ ìš”ê¸ˆì…ë‹ˆë‹¤.</p>
                </div>

                <div class="input-group">
                    <label for="additionalTvPlan" class="input-label">ì¶”ê°€ í—¬ë¡œtv ì„ íƒ (2ë²ˆì§¸ TV)</label>
                    <select id="additionalTvPlan" class="select-field">
                        <option value="none">ì„ íƒ ì•ˆí•¨</option>
                        {/* Options will be populated by JavaScript */}
                    </select>
                </div>
            </div>

            <div class="input-group mt-6">
                <label class="input-label">ëª¨ë°”ì¼ ì •ë³´ (ê²°í•© í• ì¸ì— ì˜í–¥)</label>
                <div class="flex items-center mb-2">
                     <label for="mobileCarrier" class="mr-2 text-sm text-slate-700">ê²°í•©í•  ëª¨ë°”ì¼ í†µì‹ ì‚¬:</label>
                    <select id="mobileCarrier" class="select-field w-auto">
                        <option value="none">ì„ íƒ ì•ˆí•¨ (ê²°í•© ì—†ìŒ)</option>
                        <option value="SK">SKT</option>
                        <option value="KT">KT</option>
                        <option value="LG">LG U+</option>
                        <option value="HelloMobile">í—¬ë¡œëª¨ë°”ì¼ (ì•Œëœ°í°)</option>
                    </select>
                </div>
                 <p class="text-xs text-slate-500 mt-1">ì°¸ê³ : íƒ€ì‚¬ ëª¨ë°”ì¼ ë˜ëŠ” í—¬ë¡œëª¨ë°”ì¼ ê²°í•© ì‹œ ì¸í„°ë„· ìš”ê¸ˆ í• ì¸ì´ ì ìš©ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
            </div>
        </section>

        <section id="discountTypeSection" class="mb-8">
            <h2 class="section-title">2. ê²°í•© í• ì¸ ìœ í˜• ì„ íƒ (ì°¸ê³ ìš©)</h2>
            <div class="bg-white p-6 rounded-lg shadow">
                <p class="mb-4 text-sm text-slate-600">ì„ íƒëœ ëª¨ë°”ì¼ í†µì‹ ì‚¬ì— ë”°ë¼ ì ìš© ê°€ëŠ¥í•œ ê²°í•© í• ì¸ì´ ì•„ë˜ì— í‘œì‹œë©ë‹ˆë‹¤. (ì‹¤ì œ í• ì¸ì€ ìœ„ ëª¨ë°”ì¼ í†µì‹ ì‚¬ ì„ íƒì— ë”°ë¼ ìë™ ê³„ì‚°)</p>
                <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-x-4 gap-y-2">
                    <div class="flex items-center">
                        <label class="radio-label"><input type="radio" name="discountTypeDisplay" value="none" class="radio-input" checked disabled> ê²°í•©í• ì¸ ì—†ìŒ</label>
                    </div>
                    <div class="flex items-center">
                        <label class="radio-label"><input type="radio" name="discountTypeDisplay" value="mno_equivalent" class="radio-input" disabled> íƒ€ì‚¬ ëª¨ë°”ì¼ ê²°í•©</label>
                    </div>
                     <div class="flex items-center">
                        <label class="radio-label"><input type="radio" name="discountTypeDisplay" value="thrifty_bundle" class="radio-input" disabled> ì•Œëœ°í° ê²°í•©</label>
                    </div>
                </div>
                <div id="bundleDetailsContainer" class="mt-3 hidden discount-details">
                     <p class="font-semibold mb-1">ì„ íƒëœ ê²°í•© í• ì¸ ìƒì„¸:</p>
                     <p>ì˜ˆìƒ ì¸í„°ë„· í• ì¸: <span id="detailBundleInternetDiscount" class="font-bold">0</span>ì›</p>
                     <p class="text-xs mt-1" id="detailBundleDescription"></p>
                </div>
            </div>
        </section>

        <section id="installationSection" class="mb-8">
            <h2 class="section-title">3. ì„¤ì¹˜ ì˜µì…˜</h2>
            <div class="input-group bg-white p-6 rounded-lg shadow">
                <label class="input-label">ì„¤ì¹˜ í¬ë§ ì‹œì  (ì„¤ì¹˜ë¹„ ë³€ë™)</label>
                <div class="space-y-2">
                    <label class="radio-label"><input type="radio" name="installationTime" value="weekday" class="radio-input" checked> í‰ì¼ ì£¼ê°„</label>
                    <label class="radio-label"><input type="radio" name="installationTime" value="weekend" class="radio-input"> ì£¼ë§/ì•¼ê°„ (í• ì¦ ì ìš©)</label>
                </div>
            </div>
        </section>

        <div class="text-center mb-8">
            <button id="calculateButton" class="btn-primary text-lg">ì˜ˆìƒ ìš”ê¸ˆ ê³„ì‚°í•˜ê¸°</button>
        </div>

        <section id="resultSection" class="hidden">
            <h2 class="section-title">ğŸ“Š ê³„ì‚° ê²°ê³¼</h2>
            
            <div class="result-card">
                <h3 class="text-xl font-semibold text-lime-700 mb-3">ìš”ê¸ˆ ìš”ì•½ (VAT í¬í•¨)</h3>
                <div class="grid md:grid-cols-2 gap-4">
                    <div>
                        <p class="result-label summary-item">ì„ íƒ ì¸í„°ë„·: <span id="selectedInternet" class="result-value"></span></p>
                        <p class="result-label summary-item">ì„ íƒ í—¬ë¡œtv (1ë²ˆì§¸): <span id="selectedTv" class="result-value"></span></p>
                        <p class="result-label summary-item">ì„ íƒ ì¶”ê°€ í—¬ë¡œtv (2ë²ˆì§¸): <span id="selectedAdditionalTv" class="result-value"></span></p>
                        <p class="result-label summary-item">ê²°í•© ëª¨ë°”ì¼ í†µì‹ ì‚¬: <span id="selectedMobileCarrier" class="result-value"></span></p>
                        <p class="result-label summary-item">ì ìš© í• ì¸ ìœ í˜•: <span id="selectedDiscountTypeText" class="result-value"></span></p>
                    </div>
                    <div>
                        <p class="result-label summary-item">ì›” ì¸í„°ë„· ê¸°ë³¸ë£Œ (ìœ í˜• ë°˜ì˜): <span id="totalBaseInternetCost" class="result-value">0</span> ì›</p>
                        <p class="result-label text-green-600 summary-item">ì›” ì´ ì¸í„°ë„· ê²°í•© í• ì¸ì•¡: <span id="totalInternetDiscountAmount" class="result-value text-green-600">0</span> ì›</p>
                        
                        <div id="tvCostSummaryContainer" class="hidden"> 
                            <hr class="my-1 border-slate-200">
                            <p class="result-label summary-item">ì›” í—¬ë¡œtv ìš”ê¸ˆ (1ë²ˆì§¸): <span id="tvBaseCostDisplay" class="result-value">0</span> ì›</p>
                        </div>
                         <div id="additionalTvCostSummaryContainer" class="hidden">
                            <hr class="my-1 border-slate-200">
                            <p class="result-label summary-item">ì›” ì¶”ê°€ í—¬ë¡œtv ìš”ê¸ˆ (2ë²ˆì§¸): <span id="additionalTvCostDisplay" class="result-value">0</span> ì›</p>
                        </div>
                        <hr class="my-1 border-lime-300">
                        <p class="mt-2 text-lg font-semibold">ìµœì¢… ì˜ˆìƒ ì›” ë‚©ë¶€ì•¡: <span id="finalMonthlyCost" class="total-value">0</span> ì›</p>
                    </div>
                </div>
            </div>

            <div class="result-card">
                <h3 class="text-xl font-semibold text-lime-700 mb-3">ğŸ ì‚¬ì€í’ˆ í˜œíƒ (ì˜ˆìƒ í˜„ê¸ˆ)</h3>
                <p class="result-label summary-item">í˜„ê¸ˆ ì‚¬ì€í’ˆ: <span id="giftCash" class="result-value">0</span> ì›</p>
                 <p class="text-xs text-lime-700 mt-1">* ì‚¬ì€í’ˆ ì •ë³´ëŠ” ë³€ë™ë  ìˆ˜ ìˆìœ¼ë‹ˆ ê°€ì… ì‹œì ì— ë°˜ë“œì‹œ ì¬í™•ì¸ ë°”ëë‹ˆë‹¤.</p>
            </div>

            <div class="result-card">
                <h3 class="text-xl font-semibold text-lime-700 mb-3">ì´ˆê¸° ì„¤ì¹˜ ë¹„ìš© (ì„ íƒí•œ ëª¨ë“  ìœ ì„  ì„œë¹„ìŠ¤ ê¸°ì¤€)</h3>
                <p class="result-label">ì˜ˆìƒ ì´ ì„¤ì¹˜ë¹„: <span id="installationCostResult" class="result-value text-lg">0</span> ì›</p>
                <p class="text-xs text-slate-500 mt-1">* ì„ íƒí•˜ì‹  ì„¤ì¹˜ ì‹œì (í‰ì¼/ì£¼ë§) ë° ì„œë¹„ìŠ¤ ì¡°í•©ì— ë”°ë¼ ê³„ì‚°ë©ë‹ˆë‹¤.</p>
            </div>
            
             <div class="result-card mt-6">
                <h3 class="text-xl font-semibold text-lime-700 mb-2">ì¶”ê°€ ì•ˆë‚´ì‚¬í•­</h3>
                <ul class="list-disc list-inside text-sm text-slate-600 space-y-1">
                    <li>ë³¸ ê³„ì‚°ê¸°ëŠ” ì œê³µëœ LGí—¬ë¡œë¹„ì „ ìƒí’ˆ ì •ë³´ë¥¼ ë°”íƒ•ìœ¼ë¡œ í•œ ì¶”ì •ì¹˜ì…ë‹ˆë‹¤.</li>
                    <li>ì‹¤ì œ ìš”ê¸ˆì€ LGí—¬ë¡œë¹„ì „ì˜ ìµœì‹  ì •ì±…, ê°€ì… ì‹œì ì˜ í”„ë¡œëª¨ì…˜, ì¶”ê°€ ì„ íƒ ì‚¬í•­ì— ë”°ë¼ ë‹¬ë¼ì§ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</li>
                    <li>ì•½ì • ê¸°ê°„ ë‚´ í•´ì§€ ì‹œ ìœ„ì•½ê¸ˆ(í• ì¸ë°˜í™˜ê¸ˆ ë° ì¥ë¹„ë³€ìƒê¸ˆ)ì´ ë°œìƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</li>
                    <li>ë” ì •í™•í•œ ì •ë³´ëŠ” LGí—¬ë¡œë¹„ì „ ê³ ê°ì„¼í„°(1855-1000)ë¥¼ í†µí•´ í™•ì¸í•˜ì‹œê¸° ë°”ëë‹ˆë‹¤.</li>
                </ul>
            </div>
        </section>
        
        <section id="messageScriptSection" class="hidden mt-12">
            <h2 class="section-title">ğŸ“„ ê³ ê° ì•ˆë‚´ ë¬¸ì ìŠ¤í¬ë¦½íŠ¸ (ìƒë‹´ì› ì°¸ê³ ìš©)</h2>
            <div class="result-card">
                <h3 class="text-xl font-semibold text-lime-700 mb-3">1. ì „ì‚° ë©”ëª¨</h3>
                <textarea id="memoScript" class="message-script-area" readonly></textarea>
                <div class="copy-button-container">
                    <button onclick="copyToClipboard('memoScript', 'copyFeedbackMemo')" class="btn-secondary text-xs">ë³µì‚¬í•˜ê¸°</button>
                    <span id="copyFeedbackMemo" class="copy-feedback"></span>
                </div>
            </div>
            <div class="result-card">
                <h3 class="text-xl font-semibold text-lime-700 mb-3">2. ìƒí’ˆ ì•ˆë‚´ ë¬¸ì</h3>
                <textarea id="infoScript" class="message-script-area" readonly></textarea>
                 <div class="copy-button-container">
                    <button onclick="copyToClipboard('infoScript', 'copyFeedbackInfo')" class="btn-secondary text-xs">ë³µì‚¬í•˜ê¸°</button>
                    <span id="copyFeedbackInfo" class="copy-feedback"></span>
                </div>
            </div>
            <div class="result-card">
                <h3 class="text-xl font-semibold text-lime-700 mb-3">3. ê°€ì… ì™„ë£Œ ë¬¸ì</h3>
                <textarea id="completeScript" class="message-script-area" readonly></textarea>
                 <div class="copy-button-container">
                    <button onclick="copyToClipboard('completeScript', 'copyFeedbackComplete')" class="btn-secondary text-xs">ë³µì‚¬í•˜ê¸°</button>
                    <span id="copyFeedbackComplete" class="copy-feedback"></span>
                </div>
            </div>
            <div class="result-card">
                <h3 class="text-xl font-semibold text-lime-700 mb-3">4. ë¯¼ê°ì •ë³´ ì „ì†¡ìš© ë§í¬ (ê³ ê° ë°œì†¡ìš©)</h3>
                <textarea id="sensitiveInfoLinkScript" class="message-script-area" readonly></textarea>
                <div class="copy-button-container">
                    <button onclick="copyToClipboard('sensitiveInfoLinkScript', 'copyFeedbackSensitiveLink')" class="btn-secondary text-xs">ë³µì‚¬í•˜ê¸°</button>
                    <span id="copyFeedbackSensitiveLink" class="copy-feedback"></span>
                </div>
            </div>
        </section>
    </main>

    <footer class="text-center p-6 mt-12 bg-lime-700 text-lime-100 text-sm">
        <p>ë³¸ ê³„ì‚°ê¸°ëŠ” LG HelloVision íŒë§¤ì  ë¯¸ì†Œì— ì œê³µí•©ë‹ˆë‹¤.</p>
        <p>&copy; 2024 LG HelloVision ê²°í•© í• ì¸ ê³„ì‚°ê¸°. ëª¨ë“  ì •ë³´ëŠ” ì°¸ê³ ìš©ì…ë‹ˆë‹¤.</p>
    </footer>

    <script>
        const lgHelloVisionData = {
            "service_provider": "LG HelloVision",
            "internet_plans": {
                "standalone": [
                    { "speed": "100Mbps", "monthly_fee": 20790, "description": "ì¸í„°ë„·(ë‹¨ë…) 100mb", "type": "100Mbps" },
                    { "speed": "160Mbps", "monthly_fee": 25410, "description": "ì¸í„°ë„·(ë‹¨ë…) 160mb", "type": "160Mbps" },
                    { "speed": "500Mbps", "monthly_fee": 29260, "description": "ì¸í„°ë„·(ë‹¨ë…) 500mb", "type": "500Mbps" },
                    { "speed": "1Gbps", "monthly_fee": 30800, "description": "ì¸í„°ë„·(ë‹¨ë…) 1GB", "type": "1Gbps" }
                ],
                "when_bundled_with_tv": [
                    { "speed": "100Mbps", "monthly_fee": 16330, "description": "ì¸í„°ë„· 100mb (TV ê²°í•© ì‹œ)", "type": "100Mbps" },
                    { "speed": "160Mbps", "monthly_fee": 19960, "description": "ì¸í„°ë„· 160mb (TV ê²°í•© ì‹œ)", "type": "160Mbps" },
                    { "speed": "500Mbps", "monthly_fee": 22990, "description": "ì¸í„°ë„· 500mb (TV ê²°í•© ì‹œ)", "type": "500Mbps" },
                    { "speed": "1Gbps", "monthly_fee": 24200, "description": "ì¸í„°ë„· 1GB (TV ê²°í•© ì‹œ)", "type": "1Gbps" }
                ]
            },
            "tv_plans": [
                { "key": "economy_uhd", "plan_name": "ì´ì½”ë…¸ë¯¸ UHD", "channels": 111, "monthly_fee": 13200, "resolution": "UHD" },
                { "key": "newbasic_uhd", "plan_name": "ë‰´ë² ì´ì§ UHD", "channels": 251, "monthly_fee": 15400, "resolution": "UHD" },
                { "key": "prolite_uhd", "plan_name": "í”„ë¡œë¼ì´íŠ¸ UHD", "channels": 218, "monthly_fee": 17600, "resolution": "UHD" },
                { "key": "promax_uhd", "plan_name": "í”„ë¡œë§¥ìŠ¤ UHD", "channels": 246, "monthly_fee": 17600, "resolution": "UHD" }
            ],
            "additional_tv_fees": [
                { "key": "add_economy_uhd", "plan_name_original": "ì´ì½”ë…¸ë¯¸ UHD", "monthly_fee": 5500, "description": "TV ì¶”ê°€ ì´ì½”ë…¸ë¯¸ UHD" },
                { "key": "add_newbasic_hd", "plan_name_original": "ë‰´ë² ì´ì§ HD", "monthly_fee": 8800, "description": "TV ì¶”ê°€ ë‰´ë² ì´ì§ HD" },
                { "key": "add_newbasic_uhd", "plan_name_original": "ë‰´ë² ì´ì§ UHD", "monthly_fee": 11000, "description": "TV ì¶”ê°€ ë‰´ë² ì´ì§ UHD" },
                { "key": "add_prolite_uhd", "plan_name_original": "í”„ë¡œë¼ì´íŠ¸ UHD", "monthly_fee": 11550, "description": "TV ì¶”ê°€ í”„ë¡œë¼ì´íŠ¸ UHD" },
                { "key": "add_promax_uhd", "plan_name_original": "í”„ë¡œë§¥ìŠ¤ UHD", "monthly_fee": 13750, "description": "TV ì¶”ê°€ í”„ë¡œë§¥ìŠ¤ UHD" }
            ],
            "promotional_gifts": [
                { "condition_type": "ì¸í„°ë„· ë‹¨ë…", "internet_speed": "100Mbps", "gift_value": 0 },
                { "condition_type": "ì¸í„°ë„· ë‹¨ë…", "internet_speed": "160Mbps", "gift_value": 130000 },
                { "condition_type": "ì¸í„°ë„· ë‹¨ë…", "internet_speed": "500Mbps", "gift_value": 180000 },
                { "condition_type": "ì¸í„°ë„· ë‹¨ë…", "internet_speed": "1Gbps", "gift_value": 200000 },
                { "condition_type": "ì¸í„°ë„· + TV ê²°í•©", "internet_speed": "100Mbps", "tv_plan_search_key": "ì´ì½”ë…¸ë¯¸ UHD", "gift_value": 230000 },
                { "condition_type": "ì¸í„°ë„· + TV ê²°í•©", "internet_speed": "160Mbps", "tv_plan_search_key": "ì´ì½”ë…¸ë¯¸ UHD", "gift_value": 300000 },
                { "condition_type": "ì¸í„°ë„· + TV ê²°í•©", "internet_speed": "500Mbps", "tv_plan_search_key": "ì´ì½”ë…¸ë¯¸ UHD", "gift_value": 350000 },
                { "condition_type": "ì¸í„°ë„· + TV ê²°í•©", "internet_speed": "1Gbps", "tv_plan_search_key": "ì´ì½”ë…¸ë¯¸ UHD", "gift_value": 400000 },
                { "condition_type": "ì¸í„°ë„· + TV ê²°í•©", "internet_speed": "100Mbps", "tv_plan_search_key": "ë‰´ë² ì´ì§ UHD", "gift_value": 230000 },
                { "condition_type": "ì¸í„°ë„· + TV ê²°í•©", "internet_speed": "160Mbps", "tv_plan_search_key": "ë‰´ë² ì´ì§ UHD", "gift_value": 300000 },
                { "condition_type": "ì¸í„°ë„· + TV ê²°í•©", "internet_speed": "500Mbps", "tv_plan_search_key": "ë‰´ë² ì´ì§ UHD", "gift_value": 350000 },
                { "condition_type": "ì¸í„°ë„· + TV ê²°í•©", "internet_speed": "1Gbps", "tv_plan_search_key": "ë‰´ë² ì´ì§ UHD", "gift_value": 400000 },
                { "condition_type": "ì¸í„°ë„· + TV ê²°í•©", "internet_speed": "160Mbps", "tv_plan_search_key": "í”„ë¡œë¼ì´íŠ¸ UHD", "gift_value": 300000 },
                { "condition_type": "ì¸í„°ë„· + TV ê²°í•©", "internet_speed": "500Mbps", "tv_plan_search_key": "í”„ë¡œë¼ì´íŠ¸ UHD", "gift_value": 350000 },
                { "condition_type": "ì¸í„°ë„· + TV ê²°í•©", "internet_speed": "1Gbps", "tv_plan_search_key": "í”„ë¡œë¼ì´íŠ¸ UHD", "gift_value": 400000 },
                { "condition_type": "ì¸í„°ë„· + TV ê²°í•©", "internet_speed": "160Mbps", "tv_plan_search_key": "í”„ë¡œë§¥ìŠ¤ UHD", "gift_value": 300000 },
                { "condition_type": "ì¸í„°ë„· + TV ê²°í•©", "internet_speed": "500Mbps", "tv_plan_search_key": "í”„ë¡œë§¥ìŠ¤ UHD", "gift_value": 350000 },
                { "condition_type": "ì¸í„°ë„· + TV ê²°í•©", "internet_speed": "1Gbps", "tv_plan_search_key": "í”„ë¡œë§¥ìŠ¤ UHD", "gift_value": 400000 }
            ],
            "bundle_discounts": {
                "mno_equivalent_discounts": {
                    "internet_standalone_discounts": [
                        { "internet_speed": "100Mbps", "discount_amount": 4160 },
                        { "internet_speed": "160Mbps", "discount_amount": 5090 },
                        { "internet_speed": "500Mbps", "discount_amount": 5860 },
                        { "internet_speed": "1Gbps", "discount_amount": 6160 }
                    ],
                    "internet_tv_bundle_discounts": [
                        { "internet_speed": "100Mbps", "discount_amount": 4160, "condition": "í”„ë¡œë¼ì´íŠ¸/ë§¥ìŠ¤ TV ìš”ê¸ˆì œì™€ ê²°í•© ì ‘ìˆ˜ ë¶ˆê°€" },
                        { "internet_speed": "160Mbps", "discount_amount": 5080 },
                        { "internet_speed": "500Mbps", "discount_amount": 5860 },
                        { "internet_speed": "1Gbps", "discount_amount": 6160 }
                    ]
                },
                "thrifty_bundle_discount": { "discount_amount": 2200 }
            },
            "installation_fees": [
                { "service_type": "ì¸í„°ë„· ë‹¨ë… ì„¤ì¹˜", "fee": 36300, "key": "internet_only" },
                { "service_type": "ì¸í„°ë„· + TV ì„¤ì¹˜", "fee": 56100, "key": "internet_with_tv" }
            ]
        };
        
        // DOM Element Variables
        let internetTypeRadios, internetPlanEl, tvPlanEl, additionalTvPlanEl, mobileCarrierEl,
            discountTypeDisplayRadios, bundleDetailsContainerEl, detailBundleInternetDiscountEl, detailBundleDescriptionEl,
            calculateButton, resultSection,
            selectedInternetEl, selectedTvEl, selectedAdditionalTvEl, selectedMobileCarrierDisplayEl, selectedDiscountTypeEl,
            totalBaseInternetCostEl, totalInternetDiscountAmountEl,
            tvCostSummaryContainerEl, tvBaseCostDisplayEl,
            additionalTvCostSummaryContainerEl, additionalTvCostDisplayEl,
            finalMonthlyCostEl, installationCostResultEl, giftCashEl,
            messageScriptSectionEl, memoScriptEl, infoScriptEl, completeScriptEl, sensitiveInfoLinkScriptEl,
            internetNotesEl;


        function assignDOMElements() {
            internetTypeRadios = document.querySelectorAll('input[name="internetType"]');
            internetPlanEl = document.getElementById('internetPlan');
            tvPlanEl = document.getElementById('tvPlan');
            additionalTvPlanEl = document.getElementById('additionalTvPlan');
            mobileCarrierEl = document.getElementById('mobileCarrier'); 

            discountTypeDisplayRadios = document.querySelectorAll('input[name="discountTypeDisplay"]');
            bundleDetailsContainerEl = document.getElementById('bundleDetailsContainer');
            detailBundleInternetDiscountEl = document.getElementById('detailBundleInternetDiscount');
            detailBundleDescriptionEl = document.getElementById('detailBundleDescription');

            calculateButton = document.getElementById('calculateButton');
            resultSection = document.getElementById('resultSection');
            
            selectedInternetEl = document.getElementById('selectedInternet');
            selectedTvEl = document.getElementById('selectedTv');
            selectedAdditionalTvEl = document.getElementById('selectedAdditionalTv');
            selectedMobileCarrierDisplayEl = document.getElementById('selectedMobileCarrier'); 
            selectedDiscountTypeEl = document.getElementById('selectedDiscountTypeText'); // Corrected ID
            
            totalBaseInternetCostEl = document.getElementById('totalBaseInternetCost');
            totalInternetDiscountAmountEl = document.getElementById('totalInternetDiscountAmount');
            
            tvCostSummaryContainerEl = document.getElementById('tvCostSummaryContainer');
            tvBaseCostDisplayEl = document.getElementById('tvBaseCostDisplay');

            additionalTvCostSummaryContainerEl = document.getElementById('additionalTvCostSummaryContainer');
            additionalTvCostDisplayEl = document.getElementById('additionalTvCostDisplay');

            finalMonthlyCostEl = document.getElementById('finalMonthlyCost');
            installationCostResultEl = document.getElementById('installationCostResult');
            giftCashEl = document.getElementById('giftCash');

            messageScriptSectionEl = document.getElementById('messageScriptSection');
            memoScriptEl = document.getElementById('memoScript');
            infoScriptEl = document.getElementById('infoScript');
            completeScriptEl = document.getElementById('completeScript');
            sensitiveInfoLinkScriptEl = document.getElementById('sensitiveInfoLinkScript');
            internetNotesEl = document.getElementById('internetNotes');
        }


        function populateSelectWithOptionsGeneric(selectElement, dataArray, defaultKey = "none", nameKey = "plan_name", priceKey = "monthly_fee", keyProperty = "key") {
            const currentValue = selectElement.value;
            selectElement.innerHTML = `<option value="none">ì„ íƒ ì•ˆí•¨</option>`;
            dataArray.forEach((item, index) => {
                const option = document.createElement('option');
                const itemKeyValue = item[keyProperty] || item[nameKey] || `item_${index}`; 
                option.value = itemKeyValue;

                let textContent = `${item[nameKey] || item.description || item.service_type}`;
                if (item[priceKey] !== undefined && item[priceKey] !== null && item[priceKey] !== 0) {
                     textContent += ` (ì›” ${item[priceKey].toLocaleString()}ì›)`;
                }
                if (item.channels) { 
                    textContent = `${item[nameKey]} (${item.channels}ì±„ë„, ì›” ${item[priceKey].toLocaleString()}ì›)`;
                } else if (item.description && selectElement.id === 'internetPlan') { 
                     textContent = `${item.description} (ì›” ${item[priceKey].toLocaleString()}ì›)`;
                } else if (item.description && selectElement.id === 'additionalTvPlan') {
                     textContent = `${item.description} (ì›” ${item[priceKey].toLocaleString()}ì›)`;
                }

                option.textContent = textContent;
                if (item[priceKey] !== undefined) option.dataset.price = item[priceKey];
                if (item.speed) option.dataset.speed = item.speed; 
                if (item.type) option.dataset.type = item.type;   
                if (item.channels) option.dataset.channels = item.channels;
                if (item.resolution) option.dataset.resolution = item.resolution;
                
                selectElement.appendChild(option);
            });

            if (selectElement.querySelector(`option[value="${currentValue}"]`)) {
                selectElement.value = currentValue;
            } else if (defaultKey !== "none" && selectElement.querySelector(`option[value="${defaultKey}"]`)) {
                selectElement.value = defaultKey;
            } else if (defaultKey === "none" && selectElement.options.length > 0) {
                selectElement.value = "none";
            }
        }
        
        function populateInternetPlansHello(isBundle) {
            const currentInternetPlanKey = internetPlanEl.value;
            internetPlanEl.innerHTML = `<option value="none">ì„ íƒ ì•ˆí•¨</option>`;
            const plansSource = isBundle ? lgHelloVisionData.internet_plans.when_bundled_with_tv : lgHelloVisionData.internet_plans.standalone;
            
            plansSource.forEach(item => {
                const option = document.createElement('option');
                option.value = item.type; 
                option.textContent = `${item.description} (ì›” ${item.monthly_fee.toLocaleString()}ì›)`;
                option.dataset.price = item.monthly_fee;
                option.dataset.speed = item.speed; 
                option.dataset.type = item.type;   
                internetPlanEl.appendChild(option);
            });

            if (internetPlanEl.querySelector(`option[value="${currentInternetPlanKey}"]`)) {
                internetPlanEl.value = currentInternetPlanKey;
            } else {
                if (plansSource.find(p => p.type === "160Mbps")) internetPlanEl.value = "160Mbps";
                else if (plansSource.find(p => p.type === "500Mbps")) internetPlanEl.value = "500Mbps";
                else if (plansSource.length > 0) internetPlanEl.value = plansSource[0].type;
            }
             if (internetNotesEl) {
                internetNotesEl.textContent = isBundle ? "ì°¸ê³ : WiFi ê³µìœ ê¸° ë¬´ë£Œ. TV ê²°í•© ì‹œ í• ì¸ëœ ìš”ê¸ˆì…ë‹ˆë‹¤." : "ì°¸ê³ : WiFi ê³µìœ ê¸° ë¬´ë£Œ.";
            }
        }

        function handleInternetTypeChange() {
            const selectedType = document.querySelector('input[name="internetType"]:checked').value;
            const isBundle = selectedType === 'bundle';

            populateInternetPlansHello(isBundle);

            tvPlanEl.disabled = !isBundle;
            additionalTvPlanEl.disabled = !isBundle;
            
            if (!isBundle) {
                tvPlanEl.value = 'none';
                additionalTvPlanEl.value = 'none';
            } else {
                if (tvPlanEl.value === 'none' && lgHelloVisionData.tv_plans.find(p => p.key === "newbasic_uhd")) {
                     tvPlanEl.value = 'newbasic_uhd';
                }
            }
            handleTvPlanChange(); 
        }
        
        function handleTvPlanChange() {
            const isFirstTvSelected = tvPlanEl.value !== 'none';
            const isBundleType = document.querySelector('input[name="internetType"]:checked').value === 'bundle';
            
            additionalTvPlanEl.disabled = !isFirstTvSelected || !isBundleType;
            if (!isFirstTvSelected || !isBundleType) {
                additionalTvPlanEl.value = 'none';
            }
        }
        
        function updateDiscountTypeDisplay() {
            const mobileCarrier = mobileCarrierEl.value;
            let discountTypeToSelect = "none";
            if (mobileCarrier === "SK" || mobileCarrier === "KT" || mobileCarrier === "LG") {
                discountTypeToSelect = "mno_equivalent";
            } else if (mobileCarrier === "HelloMobile") {
                discountTypeToSelect = "thrifty_bundle";
            }
            
            discountTypeDisplayRadios.forEach(radio => {
                radio.checked = radio.value === discountTypeToSelect;
            });

            if (bundleDetailsContainerEl && detailBundleInternetDiscountEl && detailBundleDescriptionEl) {
                if (discountTypeToSelect !== "none") {
                    bundleDetailsContainerEl.classList.remove('hidden');
                    let discountAmount = 0;
                    let description = "";
                    const internetKey = internetPlanEl.value; 
                    const isBundle = document.querySelector('input[name="internetType"]:checked').value === 'bundle';

                    if (internetKey !== 'none') {
                        if (discountTypeToSelect === "mno_equivalent") {
                            const discountList = isBundle ? lgHelloVisionData.bundle_discounts.mno_equivalent_discounts.internet_tv_bundle_discounts : lgHelloVisionData.bundle_discounts.mno_equivalent_discounts.internet_standalone_discounts;
                            const foundDiscount = discountList.find(d => d.internet_speed === internetKey);
                            if (foundDiscount) {
                                discountAmount = foundDiscount.discount_amount;
                                description = `íƒ€ì‚¬ ëª¨ë°”ì¼(${mobileCarrier}) ê²°í•© ì‹œ ì˜ˆìƒ í• ì¸ì…ë‹ˆë‹¤. ${foundDiscount.condition || ""}`;
                            }
                        } else if (discountTypeToSelect === "thrifty_bundle") {
                            discountAmount = lgHelloVisionData.bundle_discounts.thrifty_bundle_discount.discount_amount;
                            description = lgHelloVisionData.bundle_discounts.thrifty_bundle_discount.description || "í—¬ë¡œëª¨ë°”ì¼ ê²°í•© ì‹œ ì ìš©ë˜ëŠ” í• ì¸ì…ë‹ˆë‹¤.";
                        }
                    }
                    detailBundleInternetDiscountEl.textContent = discountAmount.toLocaleString();
                    detailBundleDescriptionEl.textContent = description;

                } else {
                    bundleDetailsContainerEl.classList.add('hidden');
                }
            }
        }


        function initializeCalculator() {
            assignDOMElements();

            if (internetTypeRadios) {
                internetTypeRadios.forEach(radio => radio.addEventListener('change', handleInternetTypeChange));
            }
            if (mobileCarrierEl) {
                 mobileCarrierEl.addEventListener('change', updateDiscountTypeDisplay);
            }
            
            populateSelectWithOptionsGeneric(tvPlanEl, lgHelloVisionData.tv_plans, "newbasic_uhd", "plan_name", "monthly_fee", "key");
            populateSelectWithOptionsGeneric(additionalTvPlanEl, lgHelloVisionData.additional_tv_fees, "none", "description", "monthly_fee", "key");
            
            if (tvPlanEl) {
                tvPlanEl.addEventListener('change', handleTvPlanChange); 
            }
            
            handleInternetTypeChange(); 
            updateDiscountTypeDisplay(); 

            if(calculateButton) {
                calculateButton.addEventListener('click', calculateAndDisplayResultsLGU);
            }
        }
        
        function getInternetPlanInfoHello(internetKey, isBundleInternetType) {
            if (!internetKey || internetKey === "none") return { description: "ë¯¸ì„ íƒ", monthly_fee: 0, speed: "0Mbps", type: "none" };
            const dataSource = isBundleInternetType ? lgHelloVisionData.internet_plans.when_bundled_with_tv : lgHelloVisionData.internet_plans.standalone;
            const plan = dataSource.find(p => p.type === internetKey);
            return plan ? { ...plan } : { description: "ì˜¤ë¥˜", monthly_fee: 0, speed: "0Mbps", type: "none" };
        }
        
        function getHelloVisionDiscount(internetTypeKey, mobileCarrierValue, isBundleInternetType) {
            if (mobileCarrierValue === "none" || !internetTypeKey || internetTypeKey === "none") return 0;

            let discountAmount = 0;
            if (mobileCarrierValue === "SK" || mobileCarrierValue === "KT" || mobileCarrierValue === "LG") {
                const discountList = isBundleInternetType ? 
                                     lgHelloVisionData.bundle_discounts.mno_equivalent_discounts.internet_tv_bundle_discounts : 
                                     lgHelloVisionData.bundle_discounts.mno_equivalent_discounts.internet_standalone_discounts;
                const foundDiscount = discountList.find(d => d.internet_speed === internetTypeKey);
                if (foundDiscount) {
                    if (isBundleInternetType && internetTypeKey === "100Mbps" && foundDiscount.condition) {
                        const selectedTvKey = tvPlanEl.value;
                        const selectedTvPlan = lgHelloVisionData.tv_plans.find(p => p.key === selectedTvKey);
                        if (selectedTvPlan && (selectedTvPlan.plan_name.includes("í”„ë¡œë¼ì´íŠ¸") || selectedTvPlan.plan_name.includes("í”„ë¡œë§¥ìŠ¤"))) {
                            return 0; 
                        }
                    }
                    discountAmount = foundDiscount.discount_amount;
                }
            } else if (mobileCarrierValue === "HelloMobile") {
                discountAmount = lgHelloVisionData.bundle_discounts.thrifty_bundle_discount.discount_amount;
            }
            return discountAmount;
        }

        function calculateAndDisplayResultsLGU() {
            try {
                const selectedInternetTypeValue = document.querySelector('input[name="internetType"]:checked').value;
                const isBundleInternetType = selectedInternetTypeValue === 'bundle';

                const internetKey = internetPlanEl.value; 
                const tvKey = isBundleInternetType ? tvPlanEl.value : 'none'; 
                const additionalTvKey = isBundleInternetType ? additionalTvPlanEl.value : 'none';
                const mobileCarrierValue = mobileCarrierEl.value;
                const installationTime = document.querySelector('input[name="installationTime"]:checked').value;
                
                let currentInternetDetails = getInternetPlanInfoHello(internetKey, isBundleInternetType);
                let internetBasePrice = currentInternetDetails.monthly_fee || 0; 
                let calculatedInternetDiscount = 0; 
                
                if (internetKey !== 'none' && mobileCarrierValue !== "none") {
                    calculatedInternetDiscount = getHelloVisionDiscount(internetKey, mobileCarrierValue, isBundleInternetType);
                }
                
                updateDiscountTypeDisplay(); 
                
                let totalActualInternetDiscount = calculatedInternetDiscount;
                totalActualInternetDiscount = Math.min(totalActualInternetDiscount, internetBasePrice); 
                
                const finalInternetComponentCost = internetBasePrice - totalActualInternetDiscount;
                
                let tvBase = 0;
                if (isBundleInternetType && tvKey !== 'none' && lgHelloVisionData.tv_plans.find(p=>p.key === tvKey)) {
                    tvBase = lgHelloVisionData.tv_plans.find(p=>p.key === tvKey).monthly_fee;
                }
                const finalTvComponentCost = tvBase;
                
                let finalAdditionalTvCost = 0;
                if (isBundleInternetType && additionalTvKey !== 'none' && lgHelloVisionData.additional_tv_fees.find(p=>p.key === additionalTvKey)) {
                     finalAdditionalTvCost = lgHelloVisionData.additional_tv_fees.find(p=>p.key === additionalTvKey).monthly_fee;
                }

                const finalPhoneComponentCost = 0; 
                
                const finalMonthlyDisplayCost = finalInternetComponentCost + finalTvComponentCost + finalAdditionalTvCost + finalPhoneComponentCost;
                const totalPreDiscountMonthlyFee = internetBasePrice + finalTvComponentCost + finalAdditionalTvCost + finalPhoneComponentCost;

                if(totalBaseInternetCostEl) totalBaseInternetCostEl.textContent = internetBasePrice.toLocaleString();
                if(totalInternetDiscountAmountEl) totalInternetDiscountAmountEl.textContent = totalActualInternetDiscount.toLocaleString();

                if (isBundleInternetType && tvKey !== 'none') {
                    if(tvCostSummaryContainerEl) tvCostSummaryContainerEl.classList.remove('hidden');
                    if(tvBaseCostDisplayEl) tvBaseCostDisplayEl.textContent = tvBase.toLocaleString();
                } else {
                    if(tvCostSummaryContainerEl) tvCostSummaryContainerEl.classList.add('hidden');
                }
                
                if (isBundleInternetType && additionalTvKey !== 'none') {
                    if(additionalTvCostSummaryContainerEl) additionalTvCostSummaryContainerEl.classList.remove('hidden');
                    if(additionalTvCostDisplayEl) additionalTvCostDisplayEl.textContent = finalAdditionalTvCost.toLocaleString();
                } else {
                    if(additionalTvCostSummaryContainerEl) additionalTvCostSummaryContainerEl.classList.add('hidden');
                }
                
                if(finalMonthlyCostEl) finalMonthlyCostEl.textContent = finalMonthlyDisplayCost.toLocaleString();

                let calculatedInstallationFee = 0;
                const installKeyToLookup = determineHelloVisionInstallationKey(internetKey !== 'none', isBundleInternetType && tvKey !== 'none', isBundleInternetType && additionalTvKey !== 'none'); 
                
                const feeEntry = lgHelloVisionData["installation_fees"].find(fee => fee.key === installKeyToLookup);

                if(feeEntry){
                     calculatedInstallationFee = installationTime === 'weekend' ? (feeEntry.fee * 1.25) : feeEntry.fee; 
                } else { 
                    if (internetKey !== 'none' && isBundleInternetType && tvKey !== 'none') {
                        const fallbackFee = lgHelloVisionData["installation_fees"].find(f => f.key === "internet_with_tv");
                        if(fallbackFee) calculatedInstallationFee = installationTime === 'weekend' ? (fallbackFee.fee * 1.25) : fallbackFee.fee;
                    } else if (internetKey !== 'none') {
                        const fallbackFee = lgHelloVisionData["installation_fees"].find(f => f.key === "internet_only");
                         if(fallbackFee) calculatedInstallationFee = installationTime === 'weekend' ? (fallbackFee.fee * 1.25) : fallbackFee.fee;
                    }
                }
                
                if(selectedInternetEl) selectedInternetEl.textContent = currentInternetDetails.description;
                const tvPlanObj = isBundleInternetType && tvKey !== 'none' ? lgHelloVisionData.tv_plans.find(p=>p.key === tvKey) : null;
                if(selectedTvEl) selectedTvEl.textContent = tvPlanObj ? tvPlanObj.plan_name : 'ë¯¸ì„ íƒ';
                
                const addTvPlanObj = isBundleInternetType && additionalTvKey !== 'none' ? lgHelloVisionData.additional_tv_fees.find(p=>p.key === additionalTvKey) : null;
                if(selectedAdditionalTvEl) selectedAdditionalTvEl.textContent = addTvPlanObj ? addTvPlanObj.description : 'ë¯¸ì„ íƒ';
                
                const mobileCarrierText = mobileCarrierEl.options[mobileCarrierEl.selectedIndex].text;
                if(selectedMobileCarrierDisplayEl) selectedMobileCarrierDisplayEl.textContent = mobileCarrierText;
                
                const discountTypeDisplayMap = {
                    none: "ê²°í•©í• ì¸ ì—†ìŒ",
                    mno_equivalent: "íƒ€ì‚¬ ëª¨ë°”ì¼ ê²°í•©",
                    thrifty_bundle: "ì•Œëœ°í° ê²°í•©"
                };
                const currentDiscountTypeKey = document.querySelector('input[name="discountTypeDisplay"]:checked')?.value || "none";
                if(selectedDiscountTypeEl) selectedDiscountTypeEl.textContent = discountTypeDisplayMap[currentDiscountTypeKey];
                if(installationCostResultEl) installationCostResultEl.textContent = Math.round(calculatedInstallationFee).toLocaleString();

                let giftCashAmount = 0;
                if (internetKey !== 'none') {
                    const giftConditionType = isBundleInternetType ? "ì¸í„°ë„· + TV ê²°í•©" : "ì¸í„°ë„· ë‹¨ë…";
                    const currentInternetSpeed = currentInternetDetails.speed; 
                    
                    let foundGift = null;
                    if (giftConditionType === "ì¸í„°ë„· ë‹¨ë…") {
                        foundGift = lgHelloVisionData.promotional_gifts.find(g => 
                            g.condition_type === giftConditionType && g.internet_speed === currentInternetSpeed
                        );
                    } else { 
                        const selectedTvPlanName = tvPlanObj ? tvPlanObj.plan_name : "";
                        foundGift = lgHelloVisionData.promotional_gifts.find(g => 
                            g.condition_type === giftConditionType && 
                            g.internet_speed === currentInternetSpeed &&
                            (!g.tv_plan_search_key || selectedTvPlanName.includes(g.tv_plan_search_key))
                        );
                         if (!foundGift) { 
                            foundGift = lgHelloVisionData.promotional_gifts.find(g =>
                               g.condition_type === giftConditionType && g.internet_speed === currentInternetSpeed
                            );
                         }
                    }
                    if (foundGift) {
                        giftCashAmount = foundGift.gift_value;
                    }
                }
                if(giftCashEl) giftCashEl.textContent = giftCashAmount.toLocaleString();
                
                if(resultSection) resultSection.classList.remove('hidden');
                if(messageScriptSectionEl) messageScriptSectionEl.classList.remove('hidden');
                generateMessageScriptsHelloVision(totalPreDiscountMonthlyFee, mobileCarrierValue === "none");
            } catch (error) {
                console.error("ê³„ì‚° ì¤‘ ì˜¤ë¥˜ ë°œìƒ:", error);
                if(resultSection) resultSection.classList.remove('hidden');
                if(finalMonthlyCostEl) finalMonthlyCostEl.textContent = "ê³„ì‚° ì˜¤ë¥˜";
            }
        }

        function generateMessageScriptsHelloVision(preDiscountFee, noBundleSelected) { 
            const selectedInternetTypeValue = document.querySelector('input[name="internetType"]:checked').value;
            const isBundleInternetType = selectedInternetTypeValue === 'bundle';

            const internetKey = internetPlanEl.value;
            const tvKey = isBundleInternetType ? tvPlanEl.value : 'none';
            const additionalTvKey = isBundleInternetType ? additionalTvPlanEl.value : 'none';

            const internetPlanInfo = getInternetPlanInfoHello(internetKey, isBundleInternetType);
            const internetPlanText = internetPlanInfo.description !== "ë¯¸ì„ íƒ" ? internetPlanInfo.description : "ì¸í„°ë„· ë¯¸ì„ íƒ";
            
            let firstTvText = "í—¬ë¡œtv ë¯¸ì„ íƒ";
            if (isBundleInternetType && tvKey !== 'none' && lgHelloVisionData.tv_plans.find(p=>p.key === tvKey)) {
                firstTvText = lgHelloVisionData.tv_plans.find(p=>p.key === tvKey).plan_name;
            }
            
            const additionalTvObj = (isBundleInternetType && additionalTvKey !== 'none' && lgHelloVisionData.additional_tv_fees.find(p=>p.key === additionalTvKey));
            const additionalTvName = additionalTvObj ? additionalTvObj.description : "";
            const additionalTvTextForMsg = additionalTvObj ? `\nâ–¶ï¸ (ì¶”ê°€) ${additionalTvName}` : "";

            const finalCalculatedMonthlyFee = finalMonthlyCostEl.textContent; 
            const giftAmount = giftCashEl.textContent;
            const installFee = installationCostResultEl.textContent;
            const installTime = document.querySelector('input[name="installationTime"]:checked').value;
            
            let installFeeForWeekendMessage = "";
            const currentInstallKeyName = determineHelloVisionInstallationKey(internetKey !== 'none', isBundleInternetType && tvKey !== 'none', isBundleInternetType && additionalTvKey !== 'none');
            const feeEntryForWeekend = lgHelloVisionData["installation_fees"].find(fee => fee.key === currentInstallKeyName);
            if (feeEntryForWeekend && installTime === 'weekend' ) {
                 installFeeForWeekendMessage = (feeEntryForWeekend.fee * 1.25).toLocaleString(); 
            }


            let productDescriptionMemo = internetPlanText;
            if (isBundleInternetType && tvKey !== 'none') productDescriptionMemo += ` + ${firstTvText}`;
            if (isBundleInternetType && additionalTvKey !== 'none') productDescriptionMemo += ` + (ì¶”ê°€)${additionalTvName.split('(')[0].trim()}`;

            memoScriptEl.value = `1. ìƒí’ˆ : ${productDescriptionMemo}
2. ìš”ê¸ˆ : ${preDiscountFee.toLocaleString()}ì› (í• ì¸ ì „) / ${finalCalculatedMonthlyFee}ì› (ìµœì¢… ì˜ˆìƒ)
3. ì‚¬ì€í’ˆ : í˜„ê¸ˆ ${giftAmount}ì›
4. ì„¤ì¹˜ë¹„ : ${installFee}ì›
5. ê¸°íƒ€ : ì´ì‚¬ ì—¬ë¶€ [  ] / í¬ë§ì„¤ì¹˜ì¼ì [    ë…„   ì›”   ì¼]`;
            
            let productDescriptionInfo = `â–¶ï¸ ${internetPlanText}`;
            if (isBundleInternetType && tvKey !== 'none') productDescriptionInfo += `\nâ–¶ï¸ ${firstTvText}`;
            productDescriptionInfo += additionalTvTextForMsg;

            const bundleStatusText = noBundleSelected ? "ê²°í•©(X)" : "ê²°í•©(O)";

            infoScriptEl.value = `[ë¯¸ì†Œ] LGí—¬ë¡œë¹„ì „ ìƒí’ˆ & ì‚¬ì€í’ˆ ìš”ì•½ ì•ˆë‚´
ì•ˆë…•í•˜ì„¸ìš”, ë¯¸ì†Œ LGí—¬ë¡œë¹„ì „ ì…ë‹ˆë‹¤.
ê³ ê°ë‹˜ê»˜ì„œ ì˜¤ëŠ˜ ìƒë‹´ ë°›ìœ¼ì‹  ìƒí’ˆ ì•ˆë‚´ë“œë¦½ë‹ˆë‹¤.
${productDescriptionInfo}
â–¶ï¸ ì›” ${finalCalculatedMonthlyFee}ì› (${bundleStatusText}, ì•½ì • ì¡°ê±´ í™•ì¸ í•„ìš”)
â–¶ï¸ í˜„ê¸ˆ ì‚¬ì€í’ˆ ${giftAmount}ì›
* í˜œíƒì€ ì‹¤ì‹œê°„ìœ¼ë¡œ ë°”ë€” ìˆ˜ ìˆë‹¤ëŠ” ì  ì•ˆë‚´ë“œë¦½ë‹ˆë‹¤.
ë¯¸ì†Œ ë“œë¦¼.`;
            
            let productDescriptionComplete = `â–¶ï¸ ${internetPlanText}`;
            if (isBundleInternetType && tvKey !== 'none') productDescriptionComplete += `\nâ–¶ï¸ ${firstTvText}`;
            productDescriptionComplete += additionalTvTextForMsg;

            completeScriptEl.value = `[ë¯¸ì†Œ] LGí—¬ë¡œë¹„ì „ ê°€ì… ì™„ë£Œ ì•ˆë‚´
ì•ˆë…•í•˜ì„¸ìš”, ê³ ê°ë‹˜. ë¯¸ì†Œ LGí—¬ë¡œë¹„ì „ì…ë‹ˆë‹¤.
âœ… ê³„ì•½ì´ ì™„ë£Œë˜ì—ˆì–´ìš”, ì•„ë˜ ë‚´ìš©ì€ ê³„ì•½ì„œì™€ ë™ì¼í•œ íš¨ë ¥ì´ ìˆìœ¼ë‹ˆ ê¼¼ê¼¼íˆ ì½ì–´ì£¼ì„¸ìš”.
âš ï¸ ì•½ì • ê¸°ê°„ ë° ì¡°ê±´ì€ ê°€ì… ì‹œ ìƒì„¸ ë‚´ìš©ì„ ë°˜ë“œì‹œ í™•ì¸í•´ì£¼ì„¸ìš”.
âš ï¸ ì•½ì • ê¸°ê°„ ë‚´ í•´ì§€ ì‹œ ìœ„ì•½ê¸ˆ (í• ì¸ ë°˜í™˜ê¸ˆ) ë° ë©´ì œëœ ì„¤ì¹˜ë¹„/ì¥ë¹„ì„ëŒ€ë£Œ ë“±ì´ ë°˜í™˜ë  ìˆ˜ ìˆì–´ìš”.
âœ… ê°€ì… ìƒí’ˆ ì•ˆë‚´
${productDescriptionComplete}
â–¶ï¸ ì›” ${finalCalculatedMonthlyFee}ì› (${bundleStatusText}, ì•½ì • ì¡°ê±´ í™•ì¸ í•„ìš”)
â–¶ï¸ ì„¤ì¹˜ë¹„ ${installFee}ì› ì²« ë‹¬ í•©ì‚° ì²­êµ¬ ${installTime === 'weekday' || !installFeeForWeekendMessage || installFeeForWeekendMessage === "0" ? '' : `(ì£¼ë§/ì•¼ê°„ ì„¤ì¹˜ ì‹œ ${installFeeForWeekendMessage}ì›)`}
â–¶ï¸ í˜„ê¸ˆ ì‚¬ì€í’ˆ ${giftAmount}ì›
âœ…ì‚¬ì€í’ˆì€ ì„¤ì¹˜ í›„ 7ì¼ ì´ë‚´ ìë™ìœ¼ë¡œ ì§€ê¸‰ë˜ë‚˜ í‰ì¼ê¸°ì¤€ 5ì‹œ ì´ì „ ê°œí†µ ë°›ì•˜ë‹¤ê³  ë¬¸ì ì£¼ì‹œë©´ ë‹¹ì¼ì…ê¸ˆ ë„ì›€ë“œë¦¬ê² ìŠµë‹ˆë‹¤.
${installTime !== 'weekday' && installFeeForWeekendMessage && installFeeForWeekendMessage !== "0" ? `-> ì£¼ë§/ì•¼ê°„ ì„¤ì¹˜ë¹„ëŠ” ${installFeeForWeekendMessage}ì› ì´ì‹­ë‹ˆë‹¤.` : ''}
ë¯¸ì†Œ ë“œë¦¼.`;

            sensitiveInfoLinkScriptEl.value = `[LGí—¬ë¡œë¹„ì „] ì•„ë˜ë§í¬ì— ê³ ê°ë‹˜ì˜ ë¯¼ê°ì •ë³´ë¥¼ ì…ë ¥í•˜ì‹œë©´ LGí—¬ë¡œë¹„ì „ìœ¼ë¡œ ê³ ê°ë‹˜ì˜ ë¯¼ê°ì •ë³´ê°€ ì§ì ‘ ì „ì†¡ë©ë‹ˆë‹¤
https://miso.kr/booking/forms/secure-details?querystring=ê³ ê°ë‹˜ ì „í™”ë²ˆí˜¸`;
        }
        
        function determineHelloVisionInstallationKey(hasInternet, hasFirstTv, hasAdditionalTv) {
            if (hasInternet) {
                if (hasFirstTv) return "internet_with_tv"; 
                return "internet_only";
            } else if (hasFirstTv) { 
                const tvOnlyInstall = lgHelloVisionData.installation_fees.find(f => f.key === "tv_only"); 
                if(tvOnlyInstall) return "tv_only";
                return "internet_with_tv"; 
            }
            return null; 
        }


        function copyToClipboard(elementId, feedbackElementId) {
            const textarea = document.getElementById(elementId);
            textarea.select();
            textarea.setSelectionRange(0, 99999); 
            try {
                document.execCommand('copy');
                const feedbackEl = document.getElementById(feedbackElementId);
                feedbackEl.textContent = 'ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!';
                setTimeout(() => { feedbackEl.textContent = ''; }, 2000);
            } catch (err) {
                const feedbackEl = document.getElementById(feedbackElementId);
                feedbackEl.textContent = 'ë³µì‚¬ ì‹¤íŒ¨';
                 setTimeout(() => { feedbackEl.textContent = ''; }, 2000);
            }
            window.getSelection().removeAllRanges(); 
        }
        
        document.addEventListener('DOMContentLoaded', initializeCalculator);

    </script>
</body>
</html>
